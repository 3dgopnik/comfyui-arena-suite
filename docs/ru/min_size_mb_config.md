# Настройка минимального размера файлов для кеширования

## Обзор

Параметр `min_size_mb` позволяет контролировать минимальный размер файлов, которые будут кешироваться. Файлы меньшего размера будут пропущены.

## Способы настройки

### 1. Через интерфейс ноды

В ноде `Arena AutoCache` есть параметр `min_size_mb`:
- **Тип**: FLOAT
- **Диапазон**: 0.1 - 1000.0 MB
- **Шаг**: 0.1 MB
- **По умолчанию**: 10.0 MB (или значение из `ARENA_CACHE_MIN_SIZE_MB`)

### 2. Через переменную окружения

Установите переменную окружения `ARENA_CACHE_MIN_SIZE_MB`:

```bash
# Windows
set ARENA_CACHE_MIN_SIZE_MB=10

# Linux/macOS
export ARENA_CACHE_MIN_SIZE_MB=10
```

### 3. В GitHub Actions

```yaml
env:
  ARENA_CACHE_MIN_SIZE_MB: 10
```

## Примеры использования

### Пропуск мелких файлов (по умолчанию)
```bash
ARENA_CACHE_MIN_SIZE_MB=10  # Пропускать файлы меньше 10 MB
```

### Кеширование всех файлов
```bash
ARENA_CACHE_MIN_SIZE_MB=0.1  # Кешировать файлы от 0.1 MB
```

### Кеширование только больших файлов
```bash
ARENA_CACHE_MIN_SIZE_MB=100  # Кешировать только файлы больше 100 MB
```

## Логика работы

1. **OnDemand режим**: Файлы проверяются при первом обращении через патч `get_full_path`
2. **Preload режим**: Файлы проверяются при анализе workflow перед кешированием
3. **Пропуск**: Файлы меньшего размера помечаются как `skipped_small` в результатах

## Результаты

В JSON-ответе ноды будет показан текущий порог:

```json
{
  "ok": true,
  "cache_mode": "OnDemand",
  "min_size_mb": 10.0,
  "description": "Models will be automatically cached when first loaded via patched get_full_path (min size: 10.0 MB)"
}
```

## Рекомендации

- **10 MB** - хороший баланс для большинства случаев
- **1 MB** - для кеширования мелких LoRA файлов
- **50 MB** - для кеширования только крупных checkpoint файлов
- **0.1 MB** - для кеширования всех файлов (может замедлить работу)
